<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Star Wars ğŸ‘©ğŸ¼â€ğŸš€</title>
	<script src="./javascript.js" defer></script>
	<style>
		input {
			width: 80%;
			height: 60px;
		}
		input[type=text] {
			font-size: 2rem;
			padding-left: 8px;
		}
		.gender {
			font-size: 1.2rem;
			color: red;
		}
	</style>
</head>

<body>
	<h1>STAR WARS ğŸ›¸</h1>
	<label for="search">Search for a character:</label>
	<input type="text" id="search" name="search" >
	<!-- <button id="searchBtn">Search</button> -->

	<ul id="results"></ul>


	<script>

const searchResults = document.querySelector("#results");
const searchInput = document.querySelector("#search");

// ===========================================
// ã‚¿ã‚¤ãƒ—ã—ãªãŒã‚‰filterã‚’ã‹ã‘ã‚‹
// ===========================================
searchInput.addEventListener("keyup", (e) => {

  // ä»Šã‚¿ã‚¤ãƒ—ã—ã¦ã‚‹å€¤ã‚’æ ¼ç´ (å°æ–‡å­—ã«å¤‰ãˆã¦ã‹ã‚‰æ ¼ç´)
  const searchString = e.target.value.toLowerCase();

  // results ã®é…åˆ—ã«å¯¾ã—ã¦ filter() ã‚’ã‹ã‘ã‚‹ (ã“ã‚Œã¯ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°)
  const filteredName = json.results.filter((character) => {
    // resultså†…ã® name ã«å¯¾ã—ã¦ã‚¿ã‚¤ãƒ—ã—ãŸã‚„ã¤ãŒä¸€è‡´ã™ã‚‹ã‹è¦‹ã¦return
    return (
      // å…¨ã¦å°æ–‡å­—ã«å¤‰ãˆã¦ã‚‹ã®ã§ã€case insensitive ã«ãªã£ã¦ã„ã‚‹
      character.name.toLowerCase().includes(searchString) ||
      character.gender.toLowerCase().includes(searchString)
    );
  });

  // returnã—ãŸã®ã§ã€ã“ã“ã§é–¢æ•°ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦å†…å®¹ã‚’ç¢ºèª
  console.log(filteredName);

  // pass the filtered value
  displayCharacters(filteredName);
});

// ===========================================
// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«è¡¨ç¤ºã™ã‚‹API ã‚’å–å¾—
// ===========================================
let json = [];
async function searchPeople() {
  const res = await fetch(`https://swapi.dev/api/people/`);

  // const json = await res.json(); //ä¸Šã§ã‚°ãƒ­ãƒ¼ãƒãƒ«ã§å®šç¾©ã—ã¦ã‚‹ã®ã§ã„ã‚‰ãªã„
  json = await res.json();
  displayCharacters(json.results);

  console.log(json); // å…¨ã¦ã‚’è¡¨ç¤º
}
searchPeople();

// ===========================================
// ä¸Šã®é–¢æ•°ã‹ã‚‰ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼åŒ–ã•ã‚ŒãŸé…åˆ—ãŒå¼•æ•°ã«æ¸¡ã£ã¦ãã‚‹
// ===========================================
const displayCharacters = (characters) => {

  // map()ã§ãƒ«ãƒ¼ãƒ—ã—ã€HTMLã«è¡¨ç¤ºã•ã›ã‚‹
  const htmlString = characters
    .map((aaa) => {
      return `
    <h2>Name: ${aaa.name}
      <span class="gender"> Gender: ${aaa.gender}</span>
    </h2>
    `;
    }).join(" & ");
    // é…åˆ—ï¼ˆã¾ãŸã¯é…åˆ—é¢¨ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰ã®å…¨è¦ç´ ã‚’é †ã«é€£çµã—ãŸæ–‡å­—åˆ—ã‚’æ–°ãŸã«ä½œæˆã—ã¦è¿”ã—ã¾ã™ã€‚

    // HTMLã«æ³¨å…¥ã™ã‚‹
  searchResults.innerHTML = htmlString;
};



	</script>
</body>

</html>